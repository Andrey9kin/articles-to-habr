Add non Skydive nodes in topology


 

| Skydive 		displays the network topology by receiving the network events from 		the skydive agents. You ever wondered how to add or display in 		topology diagram, a network components which is out of the 		skydives’ agent network or a non network entities like TOR, data 		store and etc. No more worries on that, thanks to the skydive 		‘Topology Rules’ API. |
| ------------------------------------------------------------ |
| Skydive 		отображает топологию сети, получая 		сетевые события от агентов skydive. 		Вы когда-нибудь задавались вопросом, 		как добавить или отобразить на диаграмме 		топологии сетевые компоненты, которые 		находятся вне агентской сети skydives 		или не сетевые объекты, такие как TOR, 		хранилище данных и т. д. Больше не стоит 		беспокоиться об этом, благодаря 		“Правилаv 		Топологии” skydive. 		API. |


 


 

| Since 		version 0.20, Skydive provides Topology Rules API, can be used to 		create new nodes and edges and update existing nodes’ metadata. 		Topology Rules API divided in two APIs, node rule API and edge 		rule API. Node rule API is used for create a new node and update 		metadata of existing node. Edge rule API is used for create edge 		between two nodes i.e linking two nodes. |
| ------------------------------------------------------------ |
| Начиная 		с версии 0.20, Skydive 		предоставляет “Правило Топологии” 		API, 		которое может использоваться для 		создания новых узлов и ребер и для 		обновления метаданных существующих 		узлов. “Правила Топологии” API 		разделены на два API-интерфейса: 		API-интерфейс правила узла и API-интерфейс 		правила ребра. API 		правила узла используется для создания 		нового узла и обновления метаданных 		существующего узла. API 		правила ребра используется для создания 		границы между двумя узлами, т.е. 		связывает два узла. |


 


 

| In 		this blog we will see two use cases, one is a network component 		which is not part of skydive network. Secondly, a non network 		component. 		Before 		that, we will see some basic usage of Topology rules API. |
| ------------------------------------------------------------ |
| В 		этом блоге мы увидим два варианта 		использования, один из которых является 		сетевым компонентом,который не является 		частью сети skydive. 		Второй вариант - 		несетевой компонент. 		Перед 		этим мы рассмотрим некоторые основные 		способы использования API 		правил топологии. |


 

Создать Узел

Чтобы создать узел, необходимо указать уникальное имя узла и допустимый тип узла. Вы также можете предоставить некоторые дополнительные параметры.

## Обновление Метаданных Узлов

## Чтобы обновить метаданные существующего узла, необходимо предоставить "запрос гремлина" для выбора узлов, в которых вы хотите обновить метаданные. В соответствии с вашим запросом вы можете обновить метаданные одного или нескольких узлов с помощью правила одного узла.

## Создание ребра

Для создания ребра необходимо указать исходный и конечный узлы и тип связи ребра, для создания дочернего узла значение типа связи должно быть ownership аналогично для создания связи типа layer2 значение типа связи должно быть layer2. Вы можете создать более одной связи между двумя узлами, но тип связи должен быть разным.

## Первый вариант использования

В этом случае мы рассмотрим, как показать несетевое устройство в топологии skydive. Давайте рассмотрим, что у нас есть хранилище данных, которое должно быть отображено в топологической диаграмме skydive с некоторыми полезными метаданными.

Нам просто нужно создать правило узла, чтобы добавить устройство в топологию. Мы можем добавить метаданные устройства как часть команды create или позже создать одну или несколько команд update node rule.

Выполните приведенную ниже команду правила узла, чтобы добавить запоминающее устройство в схему топологии.

Выполните команду ниже правила ребра, чтобы связать созданный узел с узлом хоста

После приведенных выше команд теперь вы можете увидеть устройство, видимое на схеме топологии skydive с заданными метаданными, как показано на рисунке ниже.


 

## Второй вариант использования

В этом случае мы увидим, как добавить сетевое устройство,которое не является частью сети skydive. Давайте рассмотрим этот пример. У нас есть два агента skydive, работающих на двух разных хостах, для подключения этих двух хостов нам нужен коммутатор TOR. Даже если мы можем достичь этого, определив узлы структуры и ссылки в конфигурационном файле, давайте посмотрим, как мы можем сделать то же самое с помощью API правил топологии.

Без коммутатора TOR два агента будут выглядеть как два разных узла без каких-либо ссылок, как показано на рисунке ниже.

Теперь выполните следующие команды Правила узла, чтобы создать коммутатор TOR и порты.

Как видите, коммутатор TOR и порты созданы и добавлены в топологию skydive, и теперь топология будет выглядеть так, как показано на рисунке ниже.

Теперь выполните приведенные ниже команды Edge Rule для создания связи между коммутатором TOR, портом 1 и публичным интерфейсом хоста 1.

Выполните следующие команды, чтобы создать связь между коммутатором TOR, портом 2 и публичным интерфейсом хоста 2

Теперь создаются связи ownership и layer2 между коммутатором TOR и портом, а также связи layer2 между агентами и портами. Теперь окончательная топология будет выглядеть так, как показано на рисунке ниже.

Теперь два хоста / агента связаны правильно, и вы можете проверить подключение или создать захват кратчайшего пути между двумя хостами.